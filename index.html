<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0,userscalable=no">
	<title>快抢月饼</title>
	<script type="text/javascript" src="lib.js"></script>
	<script type="text/javascript" src="fx.js"></script>
	<script type="text/javascript" src="fastclick.js"></script>
	<style>
		body,html{margin:0;padding:0;}
		body{height:100%;}
		.wrap{width:100%;overflow: hidden;}
		.row{list-style: none;margin: 0;padding:0;}
		.row li{width:25%;height:200px;float: left;}
		.myimg{width:100%;height:100%;}
	</style>

</head>
<body>
	<div class="wrap">
	<ul class="row">
		<li><img class="myimg baba" src="baba.jpg"></li>
		<li><img class="myimg baba" src="baba.jpg"></li>
		<li><img class="myimg yuebin" src="yuebin.jpg"></li>
		<li><img class="myimg baba" src="baba.jpg"></li>
		<li><img class="myimg baba" src="baba.jpg"></li>
		<li><img class="myimg baba" src="baba.jpg"></li>
		<li><img class="myimg yuebin" src="yuebin.jpg"></li>
		<li><img class="myimg baba" src="baba.jpg"></li>
		<li><img class="myimg baba" src="baba.jpg"></li>
		<li><img class="myimg yuebin" src="yuebin.jpg"></li>
		<li><img class="myimg baba" src="baba.jpg"></li>
		<li><img class="myimg baba" src="baba.jpg"></li>
		<li><img class="myimg baba" src="baba.jpg"></li>
		<li><img class="myimg baba" src="baba.jpg"></li>
		<li><img class="myimg yuebin" src="yuebin.jpg"></li>
		<li><img class="myimg baba" src="baba.jpg"></li>
		<li><img class="myimg yuebin" src="yuebin.jpg"></li>
		<li><img class="myimg baba" src="baba.jpg"></li>
		<li><img class="myimg baba" src="baba.jpg"></li>
		<li><img class="myimg baba" src="baba.jpg"></li>
	</ul>
</div>
<script>
	var yuebin = {
		cellHeight:0,
		init:function(){
			this.initHeight();
			this.bindEvent();
			FastClick.attach(document.body);
		},
		initHeight:function(){
			this.cellHeight  = cellHeight = document.documentElement.clientHeight/4;
			$('.row li').css({'height':cellHeight});
			$('.row').css({'marginTop':-cellHeight})
			$('.wrap').css({'height':document.documentElement.clientHeight});
		},
		bindEvent:function(){
			var me = this;
			$('.row').on('click',function(e){
				var $target = $(e.target);
				var $yuebins = $('.yuebin');
				if($target.hasClass('baba')){
					me.die();
				}else if($target[0] == $yuebins.last()[0]){
					me.next();
				}else{
					return false;
				}
			})			
		},
		die:function(){
			alert('踩到粑粑，游戏结束')
		},
		next:function(){
			var clientHeight = this.clientHeight;
			//生成0,1,2,3
			var index  = Math.floor(Math.random()*100/25);
			var html = $('<li><img class="myimg baba" src="baba.jpg"></li><li><img class="myimg baba" src="baba.jpg"></li><li><img class="myimg baba" src="baba.jpg"></li><li><img class="myimg baba" src="baba.jpg"></li>');

			$('.row').prepend(html);
			
			this.initHeight();
			// $('li').eq(0).animate({
			// 	height:clientHeight
			// },500,'ease-in')
			var $newyuebin = $('.myimg').eq(index);
			//替换生成月饼
			$newyuebin.removeClass('baba');
			$newyuebin.addClass('yuebin');
			$newyuebin.attr('src','yuebin.jpg');
			
			//开始往下展现

			$('.row li').last().remove();
			$('.row li').last().remove();
			$('.row li').last().remove();
			$('.row li').last().remove();
			

		}


	}

	$(function(){
		yuebin.init();
	})

</script>
</body>
</html>